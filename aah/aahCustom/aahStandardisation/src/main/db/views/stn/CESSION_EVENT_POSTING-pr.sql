CREATE OR REPLACE VIEW STN.CESSION_EVENT_POSTING
(
   POSTING_TYPE,
   CORRELATION_UUID,
   EVENT_SEQ_ID,
   ROW_SID,
   SUB_EVENT,
   ACCOUNTING_DT,
   POLICY_ID,
   POLICY_ABBR_NM,
   STREAM_ID,
   BASIS_CD,
   BUSINESS_TYP,
   PREMIUM_TYP,
   POLICY_PREMIUM_TYP,
   POLICY_ACCIDENT_YR,
   POLICY_UNDERWRITING_YR,
   ULTIMATE_PARENT_STREAM_ID,
   ULTIMATE_PARENT_LE_CD,
   EXECUTION_TYP,
   POLICY_TYP,
   EVENT_TYP,
   BUSINESS_EVENT_TYP,
   BUSINESS_UNIT,
   ACCOUNT_CD,
   BU_LOOKUP,
   AFFILIATE,
   OWNER_LE_CD,
   COUNTERPARTY_LE_CD,
   LEDGER_CD,
   VIE_CD,
   IS_MARK_TO_MARKET,
   TAX_JURISDICTION_CD,
   CHARTFIELD_CD,
   JL_DESCRIPTION,
   TRANSACTION_CCY,
   TRANSACTION_AMT,
   FUNCTIONAL_CCY,
   FUNCTIONAL_AMT,
   REPORTING_CCY,
   REPORTING_AMT,
   LPG_ID
)
   BEQUEATH DEFINER
AS
   SELECT 'ORIGINAL' posting_type,
          correlation_uuid,
          event_seq_id,
          row_sid,
          sub_event,
          accounting_dt,
          policy_id,
          SUBSTRB (policy_abbr_nm, 1, 50) policy_abbr_nm,
          stream_id,
          basis_cd,
          business_typ,
          premium_typ,
          policy_premium_typ,
          policy_accident_yr,
          policy_underwriting_yr,
          ultimate_parent_stream_id,
          ultimate_parent_le_cd,
          execution_typ,
          policy_typ,
          event_typ,
          business_event_typ,
          business_unit,
          account_cd,
          bu_lookup,
          affiliate,
          owner_le_cd,
          counterparty_le_cd,
          ledger_cd,
          vie_cd,
          is_mark_to_market,
          tax_jurisdiction_cd,
          chartfield_cd,
          jl_description,
          transaction_ccy,
          transaction_amt,
          functional_ccy,
          functional_amt,
          reporting_ccy,
          reporting_amt,
          lpg_id
     FROM stn.cev_non_intercompany_data
   UNION ALL
   SELECT 'ORIGINAL' posting_type,
          correlation_uuid,
          event_seq_id,
          row_sid,
          sub_event,
          accounting_dt,
          policy_id,
          SUBSTRB (policy_abbr_nm, 1, 50) policy_abbr_nm,
          stream_id,
          basis_cd,
          business_typ,
          premium_typ,
          policy_premium_typ,
          policy_accident_yr,
          policy_underwriting_yr,
          ultimate_parent_stream_id,
          ultimate_parent_le_cd,
          execution_typ,
          policy_typ,
          event_typ,
          business_event_typ,
          business_unit,
          account_cd,
          bu_lookup,
          affiliate,
          owner_le_cd,
          counterparty_le_cd,
          ledger_cd,
          vie_cd,
          is_mark_to_market,
          tax_jurisdiction_cd,
          chartfield_cd,
          jl_description,
          transaction_ccy,
          transaction_amt,
          functional_ccy,
          functional_amt,
          reporting_ccy,
          reporting_amt,
          lpg_id
     FROM stn.cev_intercompany_data
   UNION ALL
   SELECT posting_type,
          correlation_uuid,
          event_seq_id,
          row_sid,
          sub_event,
          accounting_dt,
          policy_id,
          SUBSTRB (policy_abbr_nm, 1, 50) policy_abbr_nm,
          stream_id,
          basis_cd,
          business_typ,
          premium_typ,
          policy_premium_typ,
          policy_accident_yr,
          policy_underwriting_yr,
          ultimate_parent_stream_id,
          ultimate_parent_le_cd,
          execution_typ,
          policy_typ,
          event_typ,
          business_event_typ,
          business_unit,
          account_cd,
          bu_lookup,
          affiliate,
          owner_le_cd,
          counterparty_le_cd,
          ledger_cd,
          vie_cd,
          is_mark_to_market,
          tax_jurisdiction_cd,
          chartfield_cd,
          jl_description,
          transaction_ccy,
          transaction_amt,
          functional_ccy,
          functional_amt,
          reporting_ccy,
          reporting_amt,
          lpg_id
     FROM stn.cev_vie_data;


GRANT SELECT ON STN.CESSION_EVENT_POSTING TO AAH_READ_ONLY;
