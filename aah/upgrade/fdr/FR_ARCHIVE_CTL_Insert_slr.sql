delete from FDR.FR_ARCHIVE_CTL where ARCT_ID IN(1,4,254,255);
Insert into FDR.FR_ARCHIVE_CTL (ARCT_ID,ARCT_SCHEMA_NAME,ARCT_TABLE_NAME,ARCT_ARC_SCHEMA_NAME,ARCT_ARC_TABLE_NAME,ARCT_ARC_TABLESPACE_NAME,ARCT_ARCHIVE,ARCT_ARCHIVE_DATE_COLUMN,ARCT_ARCHIVE_DAYS,ARCT_ARCHIVE_WHERE_CLAUSE,ARCT_ARCHIVE_ORDER,ARCT_BEFORE_PROCESS_PROC,ARCT_AFTER_PROCESS_PROC,ARCT_ARCHIVE_GROUP,ARCT_TARGET_TABLE_DB_LINK,ARCT_GENERATE_SCRIPT_ONLY,ARCT_DATA_TRANSFER_METHOD,ARCT_LPG_COLUMN_NAME,ARCT_ENTITY_COLUMN_NAME) values (1,'SLR','SLR_FAK_DAILY_BALANCES','SLR','SLR_FAK_DAILY_BALANCES_ARC',null,'N','FDB_BALANCE_DATE',90,'FDB_BALANCE_DATE IN (SELECT EP_BUS_PERIOD_END FROM SLR.SLR_ENTITY_PERIODS WHERE FDB_ENTITY = EP_ENTITY AND EP_STATUS = ''C''
 AND EP_BUS_PERIOD_END NOT IN(SELECT MAX(EP_BUS_PERIOD_END) FROM SLR.SLR_ENTITY_PERIODS  WHERE FDB_ENTITY = EP_ENTITY AND EP_STATUS = ''C''))
 AND FDB_EPG_ID IN (SELECT EPG_ID FROM SLR.SLR_ENTITY_PROC_GROUP WHERE EPG_ENTITY = FDB_ENTITY)',1210,'PCUST_ROLLFAKBLNCSACROSSPRDS','PCUST_ARCHIVEFAKBALANCES_AFTER',1,null,'Y','PARTITION+DML',null,'FDB_ENTITY');
Insert into FDR.FR_ARCHIVE_CTL (ARCT_ID,ARCT_SCHEMA_NAME,ARCT_TABLE_NAME,ARCT_ARC_SCHEMA_NAME,ARCT_ARC_TABLE_NAME,ARCT_ARC_TABLESPACE_NAME,ARCT_ARCHIVE,ARCT_ARCHIVE_DATE_COLUMN,ARCT_ARCHIVE_DAYS,ARCT_ARCHIVE_WHERE_CLAUSE,ARCT_ARCHIVE_ORDER,ARCT_BEFORE_PROCESS_PROC,ARCT_AFTER_PROCESS_PROC,ARCT_ARCHIVE_GROUP,ARCT_TARGET_TABLE_DB_LINK,ARCT_GENERATE_SCRIPT_ONLY,ARCT_DATA_TRANSFER_METHOD,ARCT_LPG_COLUMN_NAME,ARCT_ENTITY_COLUMN_NAME) values (4,'SLR','SLR_EBA_DAILY_BALANCES','SLR','SLR_EBA_DAILY_BALANCES_ARC',null,'N','EDB_BALANCE_DATE',90,'EDB_BALANCE_DATE IN (SELECT EP_BUS_PERIOD_END FROM SLR.SLR_ENTITY_PERIODS WHERE EDB_ENTITY = EP_ENTITY AND EP_STATUS = ''C''
 AND EP_BUS_PERIOD_END NOT IN(SELECT MAX(EP_BUS_PERIOD_END) FROM SLR.SLR_ENTITY_PERIODS  WHERE EDB_ENTITY = EP_ENTITY AND EP_STATUS = ''C''))
 AND EDB_EPG_ID IN (SELECT EPG_ID FROM SLR.SLR_ENTITY_PROC_GROUP WHERE EPG_ENTITY = EDB_ENTITY)',1230,'PCUST_ROLLEBABLNCSACROSSPRDS','PCUST_ARCHIVEEBABALANCES_AFTER',1,null,'Y','PARTITION+DML',null,'EDB_ENTITY');
Insert into FDR.FR_ARCHIVE_CTL (ARCT_ID,ARCT_SCHEMA_NAME,ARCT_TABLE_NAME,ARCT_ARC_SCHEMA_NAME,ARCT_ARC_TABLE_NAME,ARCT_ARC_TABLESPACE_NAME,ARCT_ARCHIVE,ARCT_ARCHIVE_DATE_COLUMN,ARCT_ARCHIVE_DAYS,ARCT_ARCHIVE_WHERE_CLAUSE,ARCT_ARCHIVE_ORDER,ARCT_BEFORE_PROCESS_PROC,ARCT_AFTER_PROCESS_PROC,ARCT_ARCHIVE_GROUP,ARCT_TARGET_TABLE_DB_LINK,ARCT_GENERATE_SCRIPT_ONLY,ARCT_DATA_TRANSFER_METHOD,ARCT_LPG_COLUMN_NAME,ARCT_ENTITY_COLUMN_NAME) values (254,'SLR','SLR_FAK_DAILY_BALANCES','SLR','SLR_FAK_DAILY_BALANCES_ARC',null,'N','FDB_BALANCE_DATE',90,'NOT EXISTS (SELECT 1 FROM SLR.SLR_ENTITY_PERIODS WHERE FDB_ENTITY = EP_ENTITY
 AND ((FDB_BALANCE_DATE = EP_BUS_PERIOD_END) OR (FDB_BALANCE_DATE < EP_BUS_PERIOD_END AND FDB_BALANCE_DATE >= EP_BUS_PERIOD_START)  AND EP_STATUS = ''O''))
 AND FDB_BALANCE_DATE < (SELECT MAX(EP_BUS_PERIOD_START) FROM SLR.SLR_ENTITY_PERIODS  WHERE FDB_ENTITY = EP_ENTITY AND EP_STATUS = ''C'')
 AND FDB_EPG_ID IN (SELECT EPG_ID FROM SLR.SLR_ENTITY_PROC_GROUP WHERE EPG_ENTITY = FDB_ENTITY)',1200,'PCUST_ROLLFAKBALANCESTOME',null,1,null,'Y','PARTITION+DML',null,'FDB_ENTITY');
Insert into FDR.FR_ARCHIVE_CTL (ARCT_ID,ARCT_SCHEMA_NAME,ARCT_TABLE_NAME,ARCT_ARC_SCHEMA_NAME,ARCT_ARC_TABLE_NAME,ARCT_ARC_TABLESPACE_NAME,ARCT_ARCHIVE,ARCT_ARCHIVE_DATE_COLUMN,ARCT_ARCHIVE_DAYS,ARCT_ARCHIVE_WHERE_CLAUSE,ARCT_ARCHIVE_ORDER,ARCT_BEFORE_PROCESS_PROC,ARCT_AFTER_PROCESS_PROC,ARCT_ARCHIVE_GROUP,ARCT_TARGET_TABLE_DB_LINK,ARCT_GENERATE_SCRIPT_ONLY,ARCT_DATA_TRANSFER_METHOD,ARCT_LPG_COLUMN_NAME,ARCT_ENTITY_COLUMN_NAME) values (255,'SLR','SLR_EBA_DAILY_BALANCES','SLR','SLR_EBA_DAILY_BALANCES_ARC',null,'N','EDB_BALANCE_DATE',90,'NOT EXISTS (SELECT 1 FROM SLR.SLR_ENTITY_PERIODS WHERE EDB_ENTITY = EP_ENTITY
 AND ((EDB_BALANCE_DATE = EP_BUS_PERIOD_END) OR (EDB_BALANCE_DATE < EP_BUS_PERIOD_END AND EDB_BALANCE_DATE >= EP_BUS_PERIOD_START)  AND EP_STATUS = ''O''))
 AND EDB_BALANCE_DATE < (SELECT MAX(EP_BUS_PERIOD_START) FROM SLR.SLR_ENTITY_PERIODS  WHERE EDB_ENTITY = EP_ENTITY AND EP_STATUS = ''C'')
 AND EDB_EPG_ID IN (SELECT EPG_ID FROM SLR.SLR_ENTITY_PROC_GROUP WHERE EPG_ENTITY = EDB_ENTITY)',1220,'PCUST_ROLLEBABALANCESTOME',null,1,null,'Y','PARTITION+DML',null,'EDB_ENTITY');
commit;